<div class="container-fluid contentRow">
    <div class="row">
        <div class="col-sm-12">
            <h1 *ngIf="!edit" class="heading1">Opret ny opgave</h1>
            <h1 *ngIf="edit" class="heading1">Redigér opgave</h1>
            <form novalidate (ngSubmit)="onSubmit()" #f="ngForm" style="padding: 0 15px;" class="panel panel-default">
                <div class="panel-body">
                    <div class="form-group" style="margin-top:20px;"
                         [ngClass]="{
                         'has-error': title.invalid && (title.dirty || title.touched),
                         'has-success': title.valid && (title.dirty || title.touched)
                         }">
                        <label for="title" class="control-label">Opgavetitel * 
                            <span class="fa-stack" style="font-size:10px;" tooltip="Opgavens titel kan max være 25 karatere inkl. mellemrum">
                                <i class="fa fa-circle fa-stack-2x" style="color:#006699"></i>
                                <i class="fa fa-info fa-stack-1x fa-inverse"></i>
                            </span>
                        </label>
                        <!--<em class="form-feedback" *ngIf="title.errors.required">Skal udfyldes</em>-->
                        <input type="text" id="title" class="form-control" name="title" [(ngModel)]="model.title" #title="ngModel" maxlength="25" required />
                        <div class="form-feedback" *ngIf="title.errors && (title.dirty || title.touched)">
                            <p *ngIf="title.errors.required">Opgavens titel skal udfyldes</p>
                        </div>
                    </div>

                    <div class="form-group"
                         [ngClass]="{
                         'has-error': type.invalid && (type.dirty || type.touched),
                         'has-success': type.valid && (type.dirty || type.touched)
                         }">
                        <label for="type" class="control-label">Opgavetype *</label>
                        <select class="form-control" id="type" name="type" [(ngModel)]="model.type" #type="ngModel" required>
                            <option *ngFor="let tt of taskTypes" [value]="tt">{{ tt }}</option>
                        </select>
                        <div class="form-feedback" *ngIf="type.errors && (type.dirty || type.touched)">
                            <p *ngIf="type.errors.required">Opgavens type skal udfyldes</p>
                        </div>
                    </div>

                    <!--<div class="form-group"
                         [ngClass]="{
                         'has-error': deadline.invalid && (deadline.dirty || deadline.touched),
                         'has-success': deadline.valid && (deadline.dirty || deadline.touched)
                         }">
                        <label for="deadline" class="control-label">Deadline *</label>
                        <input type="datetime-local" id="deadline" class="form-control" name="deadline" [value]="model.deadline.format('YYYY-MM-DDTHH:mm')" (change)="deadlineChanged()" [disabled]="edit" #deadline required />
                        <div class="form-feedback" *ngIf="deadline.errors && (deadline.dirty || deadline.touched)">
                            <p *ngIf="deadline.errors.required">Deadlinen for opgaven skal udfyldes</p>
                        </div>
                    </div>-->
                    <p style="margin-bottom: 5px;font-weight: bold;">Dato og tid for opgavens deadline *</p>
                    <div class="form-group datetime-container">
                        <div class="dp-box">
                            <datepicker name="date" id="sd" #sd="ngModel" [(ngModel)]="selectedDate" [minDate]="now" [maxDate]="isEdit" [showWeeks]="true" (ngModelChange)="deadlineChanged($event)" [disabled]="edit"></datepicker>
                        </div>
                        <div class="tp-box">                        
                            <p>Timer - Minutter</p>
                            <timepicker name="time" id="st" #st="ngModel" [(ngModel)]="selectedTime" [showMeridian]="ismeridian" (ngModelChange)="deadlineChanged($event)" [disabled]="edit"></timepicker>
                            <div style="padding:30px;background-color: #fafafa;border-radius:5px;display:flex;align-items:center;flex-direction:column;">
                                Valgte deadline <br /> <b>{{ model.deadline.format('DD/MM-YYYY - HH:mm') }}</b>
                            </div>
                        </div>    
                    </div>
                    <div class="form-feedback" *ngIf="statusMessage">
                        <p>{{statusMessage}}</p>
                    </div>

                    <div class="form-group"
                         [ngClass]="{
                         'has-error': rewardType.invalid && (rewardType.dirty || rewardType.touched),
                         'has-success': rewardType.valid && (rewardType.dirty || rewardType.touched)
                         }">
                        <label for="rewardType" class="control-label">Belønning * 
                            <span class="fa-stack" style="font-size:10px;" tooltip="Hvilke type belønning den bedste løsning eller ansøgning modtager.">
                                <i class="fa fa-circle fa-stack-2x" style="color:#006699"></i>
                                <i class="fa fa-info fa-stack-1x fa-inverse"></i>
                            </span>
                        </label>
                        <select class="form-control" id="rewardType" name="rewardType" [(ngModel)]="model.rewardType" [disabled]="edit" #rewardType="ngModel" required>
                            <option value="Honorar">Honorar</option>
                            <option value="Gave">Gave</option>
                            <option value="Anbefaling">Anbefaling</option>
                        </select>
                        <div class="form-feedback" *ngIf="rewardType.errors && (rewardType.dirty || rewardType.touched)">
                            <p *ngIf="rewardType.errors.required">Belønnings typen skal udfyldes</p>
                        </div>
                    </div>

                    <div *ngIf="model.rewardType === 'Honorar' || model.rewardType  === 'Gave'" class="form-group"
                         [ngClass]="{
                         'has-error': rewardValue.invalid && (rewardValue.dirty || rewardValue.touched),
                         'has-success': rewardValue.valid && (rewardValue.dirty || rewardValue.touched)
                         }">
                        <label for="rewardValue" class="control-label">Belønningens værdi * 
                            <span class="fa-stack" style="font-size:10px;" tooltip="Belønningens værdi for enten Gave eller Honorar">
                                <i class="fa fa-circle fa-stack-2x" style="color:#006699"></i>
                                <i class="fa fa-info fa-stack-1x fa-inverse"></i>
                            </span>
                        </label>
                        <input type="number" min="0" max="5000" class="form-control" id="rewardValue" name="rewardValue" [(ngModel)]="model.rewardValue" #rewardValue="ngModel" required />
                        <div class="form-feedback" *ngIf="rewardValue.errors && (rewardValue.dirty || rewardValue.touched)">
                            <p *ngIf="rewardValue.errors.required">Værdien for belønningen skal udfyldes</p>
                        </div>
                    </div>

                    <div class="form-group"
                         [ngClass]="{
                         'has-error': workPlace.invalid && (workPlace.dirty || workPlace.touched),
                         'has-success': workPlace.valid && (workPlace.dirty || workPlace.touched)
                         }">
                        <label for="workPlace" class="control-label">Hvor opgaven skal løses *</label>
                        <select class="form-control" id="workPlace" name="workPlace" [(ngModel)]="model.workPlace" #workPlace="ngModel" required>
                            <option value="1">Hjemme</option>
                            <option value="2">Hos virksomheden</option>
                        </select>
                        <div class="form-feedback" *ngIf="workPlace.errors && (workPlace.dirty || workPlace.touched)">
                            <p *ngIf="workPlace.errors.required">Arbejds stedet for opgaven skal udfyldes</p>
                        </div>
                    </div>

                    <p *ngIf="model.workPlace ==='2'">Adressen hvor opgaven skal udføres</p>
                    <div *ngIf="model.workPlace ==='2'" class="col-sm-5" style="padding:0;">
                        <div class="form-group"
                             [ngClass]="{
                         'has-error': city.invalid && (city.dirty || city.touched),
                         'has-success': city.valid && (city.dirty || city.touched)
                         }">
                            <label for="city" class="control-label">By *</label>
                            <!--<em class="form-feedback" *ngIf="title.errors.required">Skal udfyldes</em>-->
                            <input type="text" id="city" class="form-control" name="city" [(ngModel)]="model.city" #city="ngModel" required />
                            <div class="form-feedback" *ngIf="city.errors && (city.dirty || city.touched)">
                                <p *ngIf="city.errors.required">Byen skal udfyldes</p>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="model.workPlace ==='2'" class="col-sm-5 col-sm-offset-2" style="padding:0;">
                        <div class="form-group"
                             [ngClass]="{
                         'has-error': zip.invalid && (zip.dirty || zip.touched),
                         'has-success': zip.valid && (zip.dirty || zip.touched)
                         }">
                            <label for="zip" class="control-label">Postnummer *</label>
                            <input type="number" min="0" max="5000" class="form-control" id="zip" name="zip" [(ngModel)]="model.zip" #zip="ngModel" required />
                            <div class="form-feedback" *ngIf="zip.errors && (zip.dirty || zip.touched)">
                                <p *ngIf="zip.errors.required">Postnummeret skal udfyldes</p>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="model.workPlace ==='2'" class="form-group"
                         [ngClass]="{
                         'has-error': address.invalid && (address.dirty || address.touched),
                         'has-success': address.valid && (address.dirty || address.touched)
                         }">
                        <label for="address" class="control-label">Vejnavn og nummer *</label>
                        <!--<em class="form-feedback" *ngIf="title.errors.required">Skal udfyldes</em>-->
                        <input type="text" id="address" class="form-control" name="address" [(ngModel)]="model.address" #address="ngModel" required />
                        <div class="form-feedback" *ngIf="address.errors && (address.dirty || address.touched)">
                            <p *ngIf="address.errors.required">Vejnavn og nummer skal udfyldes</p>
                        </div>
                    </div>

                    <div *ngIf="model.workPlace" class="form-group"
                         [ngClass]="{
                         'has-error': contactDescription.invalid && (contactDescription.dirty || contactDescription.touched),
                         'has-success': contactDescription.valid && (contactDescription.dirty || contactDescription.touched)
                         }">
                        <label for="contactDescription" class="control-label" style="display:flex;align-items:center;">
                            Ansøgnings beskrivelse *
                            <span class="fa-stack" style="font-size:10px;" tooltip="Forklar hvad ansøgningen til opgaven skal indeholde. Inkluder kontakt information så som e-mail eller telefonnummer, for de ansøgende at kontakte jer på.">
                                <i class="fa fa-circle fa-stack-2x" style="color:#006699"></i>
                                <i class="fa fa-info fa-stack-1x fa-inverse"></i>
                            </span>
                        </label>
                        <textarea style="resize:none;" class="form-control" rows="8" id="contactDescription" name="contactDescription" [(ngModel)]="model.contactDescription" #contactDescription="ngModel" required></textarea>
                        <span class="help-block" style="font-size:16px;"></span>
                        <div class="form-feedback" *ngIf="contactDescription.errors && (contactDescription.dirty || contactDescription.touched)">
                            <p *ngIf="contactDescription.errors.required">Ansøgnings beskrivelsen skal udfyldes</p>
                        </div>
                    </div>
                    
                    <div class="form-group"
                         [ngClass]="{
                         'has-error': description.invalid && (description.dirty || description.touched),
                         'has-success': description.valid && (description.dirty || description.touched)
                         }">
                        <label for="description" class="control-label">Opgave beskrivelse *
                            <span class="fa-stack" style="font-size:10px;" tooltip="Forklar hvad opgaven går ud på. Du kan også tilføje links til sider hvor de kan downloade PDF udgaver af en beskrivelse eller sider indholdene information.">
                                <i class="fa fa-circle fa-stack-2x" style="color:#006699"></i>
                                <i class="fa fa-info fa-stack-1x fa-inverse"></i>
                            </span>
                        </label>
                        <textarea style="resize:none;" class="form-control" rows="8" id="description" name="description" [(ngModel)]="model.description" #description="ngModel" required></textarea>
                        <div class="form-feedback" *ngIf="description.errors && (description.dirty || description.touched)">
                            <p *ngIf="description.errors.required">Opgaves beskrivelsen skal udfyldes.</p>
                        </div>
                    </div>
                    <p *ngIf="!edit">OBS! - Når du har oprettet en ny opgave, kan du ikke længere ændre i opgavens deadline, belønnings type eller belønnings værdi. Sørg derfor at disse oplysninger er korrekte før der trykkes på 'Opret opgave'.</p>
                    <div class="text-center">
                        <button type="submit" class="btn btn-success btn-lg" [disabled]="edit ? !f.dirty || f.invalid : f.invalid" style="margin-bottom:20px">{{edit ? 'Gem opgave' : 'Opret opgave'}}</button>
                    </div>
                </div>  
            </form>
        </div>
    </div>
</div>
<h2 class="heading2">Live preview af opgaven</h2>
<task-detail [task]="model" [business]="business"></task-detail>
